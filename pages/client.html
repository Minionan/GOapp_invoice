<!-- pages/client.html -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Client List Page</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="invoice-container">
        <h1>Welcome!</h1>
        <p>Here you can create, edit and delete your Client Details used on invoices.</p>
        <h2>List of saved clients</h2>
        <table id="clientTable">
            <thead>
                <tr>
                    <th>Abbr.</th>
                    <th>Client Name</th>
                    <th>Payee Name</th>
                    <th>Phone</th>
                    <th>Email</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <!-- Rows will be populated by JavaScript -->
            </tbody>
        </table>
        <br>
        <button type="button" onclick="window.location.href='/pages/clientAdd.html'">Add Client</button>
        <button type="button" onclick="window.location.href='/'">Back</button>
        <br><br>
        <fieldset>
            <legend>How to use:</legend>
            <label>
                1. Choose the client to edit.<br>
                2. Click on Edit button next to the selected client.<br>
                3. Click Add Client button if you want to create a new client. 
            </label>
        </fieldset><br>
    </div>
    <script>
        // Fetch and display clients
        fetch('/clients')
        .then(response => response.json())
        .then(data => {
            console.log('Received clients:', data); // debug line
            const tbody = document.querySelector('#clientTable tbody');
            tbody.innerHTML = '';
            data.forEach(client => {
                console.log('Processing client:', client); // debug line
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${client.abbreviation}</td>
                    <td>${client.clientName}</td>
                    <td>${client.parentName}</td>
                    <td>${client.phone}</td>
                    <td>${client.email}</td>
                    <td><button onclick="window.location.href='/pages/clientEdit.html?id=${client.id}'">Edit</button></td>
                `;
                tbody.appendChild(row);
            });
        })
        .catch(error => console.error('Error fetching clients:', error));
    </script>
</body>
</html>
